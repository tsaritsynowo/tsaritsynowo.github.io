import{w as p}from"./with-props-BIn-0Sdf.js";import{r as i,l as e,O as h,n as l}from"./chunk-GNGMS2XR-2bPrQtgl.js";function j({login:a,setLogin:s}){const[n,o]=i.useState(!1),r=i.useRef(null),d=i.useCallback(()=>{s("unlogin"),alert("退出管理员状态！")},[s]),u=i.useCallback(async()=>{const t=r.current.elements.key.value;s("logining");try{(await(await fetch("/api",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({key:t})})).json()).success?(s("login"),alert("登录成功！")):(s("unlogin"),alert("key错误！"))}catch{s("unlogin"),alert("网络错误！")}},[]),c=i.useCallback(()=>{o(!n)},[o,n]);return a==="unlogin"?e.jsxs("div",{className:"loginbtm",onClick:c,id:n?"open-login":"close-login",children:[e.jsx("p",{children:"管理员登录"}),e.jsxs("form",{className:"login-form",name:"login",ref:r,children:[e.jsx("input",{name:"key",type:"password",placeholder:"key",onClick:t=>t.stopPropagation()}),e.jsx("button",{type:"button",value:"",onClick:t=>{u(),t.stopPropagation()},children:e.jsx("i",{className:"fa fa-sign-in","aria-hidden":"true"})})]})]}):a==="logining"?e.jsx("div",{className:"loginbtm",onClick:c,id:"logining",children:e.jsx("p",{children:"登录中..."})}):e.jsxs("div",{className:"loginbtm",onClick:c,id:"welcome",children:[e.jsx("p",{children:"管理员！"}),e.jsx("button",{className:"logout-button",type:"button",value:"",onClick:d,children:e.jsx("i",{className:"fa fa-sign-out","aria-hidden":"true"})})]})}function x(){const[a,s]=i.useState(null);return i.useEffect(()=>{const n=window.location.pathname.split("/")[1];n===""&&(window.location.href="/"),s(n)},[]),e.jsxs("nav",{children:[e.jsx(l,{to:"/",children:e.jsxs("div",{className:"NavBtm",children:[e.jsx("i",{class:"fa fa-home","aria-hidden":"true"}),"主页"]})}),e.jsx(l,{to:"/project",children:e.jsxs("div",{className:"NavBtm",id:a==="project"?"active":"",onClick:()=>s("project"),children:[e.jsx("i",{class:"fa fa-code","aria-hidden":"true"}),"项目"]})}),e.jsx(l,{to:"/blog",children:e.jsxs("div",{className:"NavBtm",id:a==="blog"?"active":"",onClick:()=>s("blog"),children:[e.jsx("i",{class:"fa fa-book","aria-hidden":"true"}),"博客"]})}),e.jsx(l,{to:"/picture",children:e.jsxs("div",{className:"NavBtm",id:a==="picture"?"active":"",onClick:()=>s("picture"),children:[e.jsx("i",{class:"fa fa-picture-o","aria-hidden":"true"}),"相册"]})})]})}const v=p(function(){const[s,n]=i.useState("unlogin");return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"header",children:[e.jsx(x,{}),e.jsx(j,{login:s,setLogin:n})]}),e.jsx(h,{})]})});export{v as default};
